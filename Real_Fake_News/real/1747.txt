Sen. Ted Cruz of Texas scored a hard-fought upset win over businessman Donald Trump in the Iowa Republican caucuses Monday night, while former secretary of state Hillary Clinton and Sen. Bernie Sanders of Vermont were locked in a virtual tie on the Democratic side with most of the votes counted.

Cruz made good on his bet that a methodical campaign organization would eclipse Trumpâ€™s media dominance in the first test of Republican voters. With 99 percent of the precincts reporting, Cruz was beating his rival by more than 5,100 votes, with Sen. Marco Rubio of Florida a close third.

Cruz appeared to capitalize on deep support from religious and social conservatives and showed that old-fashioned retail politicking could overcome Trumpâ€™s massive political rallies in the Hawkeye State.

â€œGod bless the great state of Iowa,â€ Cruz told supporters at his campaignâ€™s Iowa headquarters after embracing his wife, Heidi. â€œTonight is a victory for the grass roots. Tonight is a victory for courageous conservatives across Iowa and all across this great nation. Iowa has sent notice that the Republican nominee and the next president of the United States will not be chosen by the media, will not be chosen by the Washington establishment, will not be chosen by the lobbyists.â€

Clinton had been a clear front-runner in Iowa last summer, as she hoped to make up for her loss to Barack Obama in the 2008 Democratic caucuses. But Sanders, hammering a message about economic inequities in the middle class, narrowed the margin in Iowa into a dead heat in the final days, and the results could presage a long, grueling fight to the nomination. He maintains a polling advantage in New Hampshire, which will hold its primaries next week.

With 95 percent of the precincts reporting, Clinton had 49.8 percent of the vote to Sandersâ€™s 49.6 percent. Clinton, joined by her husband, former president Bill Clinton, and daughter Chelsea, addressed supporters before the final tally was in, saying she was â€œbreathing a sigh of relief.â€

â€œIt is rare that we have the opportunity we have now to have a real contest of ideas, to really think hard about what the Democratic Party stands for,â€ Clinton said. â€œI am excited about really getting into the debate with Senator Sanders about the best way forward to fight for us and America.â€

Sanders, accompanied by wife, Jane, appeared in front of a jubilant crowd that chanted â€œFeel the Bern!â€ He said that his showing against Clinton sent a message to the political and media establishments that â€œgiven the enormous crises facing our country, it is just too late for establishment politics and establishment economics.â€

The night also began to winnow the field on both sides. Former Maryland governor Martin Oâ€™Malley, the only other major Democratic candidate, had negligible support and suspended his campaign Monday night, according to a person close to the campaign. Former Arkansas governor Mike Huckabee, a Republican, also suspended his campaign.

The crowded Republican field and lively debates appeared to boost interest in the race. A record 185,000 people took part in the GOP caucuses, increasing the 2012 turnout by 5.4 percent, according to estimates from Edison Media Research.

Trump had led the Republican polls since last summer, shortly after he declared his candidacy, and he seemed to rewrite the traditional rules and expectations of national political campaigns. Yet his outsider appeal, which swelled crowds at rallies, failed to translate entirely to the caucus turnout, and some political analysts questioned his decision to drop out of the final GOP debate last week.

Appearing before supporters at his Iowa headquarters, Trump congratulated Cruz, but he reminded his audience of how far he had come.

â€œOn June 16, when I started this journey, there were 17 candidates. I was told by everybody, â€Do not go to Iowa. You could never finish even in the top 10,â€™â€‰â€ Trump said. â€œWe finished second. .â€‰.â€‰.We will go on to get the Republican nomination, and we will go on to beat Hillary or Bernie or whoever they throw up there.â€

Cruz, who had surged to a polling lead in Iowa by December but fell behind to Trump in the past few days, outperformed his final polling results in Iowa. Aides touted a strong ground game in which the senator appeared at events in all 99 counties. Cruz had 28 percent of the vote, with Trump at 24 percent and Rubio at 23.

Supporters at Cruz headquarters cheered loudly when their candidate was shown on a giant video screen. A cover band played songs of Patsy Cline and Johnny Cash as the audience exchanged hi-fives and hoisted drinks.

â€œThatâ€™s priceless. Youâ€™re fired!â€ Cruz precinct captain Ted Sturgill said, using Trumpâ€™s catchphrase from â€œThe Apprenticeâ€ television show against him.

Whether Cruz can translate the win into similar success in New Hampshire is uncertain, as the past two Iowa winners, Pennsylvaniaâ€™s Rick Santorum in 2012 and Huckabee in 2008, failed to win the nomination.

Rubio did far better than expected, with a late rally as he sought to consolidate support among establishment Republicans who have doubted Trump and Cruz. Former Florida governor Jeb Bush, who started the campaign as a prohibitive front-runner with a massive campaign war chest, finished way back in the pack. Bush wasnâ€™t even in the state on Monday, campaigning instead in New Hampshire.

â€œThey told me I needed to wait my turn, that I needed to wait in line,â€ Rubio told an enthusiastic crowd at his Iowa headquarters.

â€œTonight here in Iowa, the people in this great state sent a very clear message that after seven years of Barack Obama, we are not waiting any longer to take our country back,â€ Rubio said.

Voters gathered at caucus sites in 99 counties around the state. The last-minute lobbying officially began at 7 p.m. Central time, with votes following. Political operatives predicted a high turnout â€” and there were reports that some sites were so packed that officials had trouble closing the doors, despite a significant snowstorm that was bearing down on the state. Forecasters said the storm would probably hit after the caucuses were closed.

â€œI pray we will win,â€ Cruz said during a stop at a Baptist church in Marion.

Trump and Sanders made their final pushes Monday to coax nontraditional voters to the caucuses, even as their chief rivals suggested that well-tested organizing tactics would give them the crucial margin of victory.

Television networks showed Trump, in a solid red tie, visiting a caucus site in West Des Moines with his wife, Melania, in a matching all-red ensemble, and taking a seat in the front row. One woman approached and posed with him for a selfie on her mobile phone.

â€œWe are going to bring our country back,â€ Trump told the crowd, speaking into a microphone. Reflecting on a campaign that was dismissed early on by the political establishment in Washington, Trump said: â€œItâ€™s really been a journey, an amazing journey. Iâ€™m a messenger. Weâ€™re going to run it the way itâ€™s supposed to be run â€” as a great, great country.â€

[Hereâ€™s how the voting in Iowa works]

There was little question that the lack of an incumbent, coupled with the unconventional style of several candidates, has sparked Iowansâ€™ interest in the race this year. Jeff Kaufmann, who chairs the Iowa Republican Party, said his office has received five to six times as many calls compared with past years.

â€œThe phone calls at the Republican Party of Iowa headquarters are absolutely unprecedented. I mean, weâ€™re looking at 100 an hour, literally,â€ he said. â€œNow, obviously, not all of that is tied to Donald Trump. Thereâ€™s also a lot of these calls that are going to a variety of candidates. But I think thatâ€™s a sign of the enthusiasm.â€

[6 Iowans explain how theyâ€™re deciding whom to vote for]

Iowa Gov. Terry Branstad (R) echoed that assessment in an interview, saying that Trump has â€œturned out bigger crowds than weâ€™ve ever seen before.â€

â€œI know everybody is saying, â€Are they just coming for curiosity?â€™ But I think theyâ€™re for real; theyâ€™re committed and will show up for caucuses,â€ Branstad said. â€œIâ€™ve been pretty impressed with what theyâ€™ve done.

â€œOf course, we saw this phenomenon eight years ago with Obama,â€ he said, referring to Obamaâ€™s first White House bid. â€œIt was beyond what anyone could have imagined, and I think Trump is a phenomenon, too.â€

The Democratic field was much smaller but no less competitive. Clinton, whose comfortable lead in Iowa evaporated earlier this year, has scrambled to try to fend off Sanders, who has attracted massive crowds and an intense grass-roots following that put an Iowa upset within reach.

Sanders was encircled by volunteers and a crush of reporters as he arrived late Monday morning at his Iowa headquarters in a strip shopping center outside downtown Des Moines.

â€œWe have come a long, long way in the last nine months,â€ the senator told his supporters. â€œYouâ€™ve got a tied ball game, thatâ€™s where we are.â€

Sanders also pushed back against critics who have suggested his agenda is too radical. â€œOur platform, our agenda, is precisely what the American people want,â€ he said.

Eilperin and Nakamura reported from Washington. Sean Sullivan, Robert Costa, Katie Zezima, Philip Rucker and John Wagner in Des Moines, and Abby Phillip in Council Bluffs, Iowa, contributed to this report.